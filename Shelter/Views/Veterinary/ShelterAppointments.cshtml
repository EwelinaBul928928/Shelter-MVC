@model List<Shelter.Models.VeterinaryAppointment>
@{
    ViewData["Title"] = "Wszystkie zapisy";
}

<div class="container mt-4">
    <h1 class="mb-4">Wszystkie zapisy na wizyty</h1>

    <div class="mb-3">
        <a href="@Url.Action("BookAppointmentForShelterAnimal", "Veterinary")" class="btn btn-primary">Zapisz zwierzę ze schroniska</a>
    </div>

    @if (Model == null || !Model.Any())
    {
        <div class="alert alert-info">
            <p class="mb-0">Brak zapisów na wizyty.</p>
        </div>
    }
    else
    {
        <div class="table-responsive">
            <table class="table table-striped table-hover">
                <thead class="table-dark">
                    <tr>
                        <th>Data wizyty</th>
                        <th>Zwierzę</th>
                        <th>Właściciel</th>
                        <th>Weterynarz</th>
                        <th>Usługa</th>
                        <th>Koszt</th>
                        <th>Status</th>
                        <th>Uwagi</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var appointment in Model)
                    {
                        <tr>
                            <td>@appointment.AppointmentDate.ToString("dd.MM.yyyy HH:mm")</td>
                            <td>
                                @if (appointment.Animal != null)
                                {
                                    <text>@appointment.Animal.Name (@appointment.Animal.Species) - <span class="badge bg-info">Schronisko</span></text>
                                }
                                else if (appointment.ClientAnimal != null)
                                {
                                    <text>@appointment.ClientAnimal.Name (@appointment.ClientAnimal.Species) - <span class="badge bg-primary">Klient</span></text>
                                }
                                else
                                {
                                    <text>-</text>
                                }
                            </td>
                            <td>
                                @if (appointment.User != null)
                                {
                                    <text>@appointment.User.FirstName @appointment.User.LastName</text>
                                }
                                else
                                {
                                    <text>-</text>
                                }
                            </td>
                            <td>@(appointment.Veterinarian != null ? $"{appointment.Veterinarian.FirstName} {appointment.Veterinarian.LastName}" : "-")</td>
                            <td>@(appointment.Service?.Name ?? "-")</td>
                            <td>
                                @if (appointment.IsFree)
                                {
                                    <span class="badge bg-success">Za darmo</span>
                                }
                                else if (appointment.Cost.HasValue)
                                {
                                    <span class="text-success fw-bold">@appointment.Cost.Value.ToString("C")</span>
                                }
                                else
                                {
                                    <text>-</text>
                                }
                            </td>
                            <td>
                                @if (appointment.Status == "Scheduled")
                                {
                                    <span class="badge bg-primary">Zaplanowana</span>
                                }
                                else if (appointment.Status == "Completed")
                                {
                                    <span class="badge bg-success">Zakończona</span>
                                }
                                else if (appointment.Status == "Cancelled")
                                {
                                    <span class="badge bg-danger">Anulowana</span>
                                }
                                else
                                {
                                    <span class="badge bg-secondary">@appointment.Status</span>
                                }
                            </td>
                            <td>@(appointment.Notes ?? "-")</td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    }
</div>
